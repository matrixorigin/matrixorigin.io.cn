# **MatrixOne v1.1.2 发布报告**

发布日期：2024 年 04 月 02 日

MatrixOne 版本：v1.1.2

与之前的 v1.1.1 相比，v1.1.2 没有引入任何新功能，而是专注于一些改进和错误修复。

## 改进

- 查询性能优化：[#14819](https://github.com/matrixorigin/matrixone/pull/14819) [#14519](https://github.com/matrixorigin/matrixone/pull/14519) [#14835](https://github.com/matrixorigin/matrixone/pull/14835)
- 备份并行化优化：[#14543](https://github.com/matrixorigin/matrixone/pull/14543)
- 支持 S3 重试：[#14992](https://github.com/matrixorigin/matrixone/pull/14992)
- 优化代理迁移功能：[#14858](https://github.com/matrixorigin/matrixone/pull/14858) [#14901](https://github.com/matrixorigin/matrixone/pull/14901) [#15162](https://github.com/matrixorigin/matrixone/pull/15162)
- 优化 UUID 性能：[#15187](https://github.com/matrixorigin/matrixone/pull/15187)

## 错误修复

- 修复了数据准确性问题：[#14653](https://github.com/matrixorigin/matrixone/pull/14653)
- 修复了事务提交 WW 和 DUP 问题：[#15034](https://github.com/matrixorigin/matrixone/pull/15034) [#15123](https://github.com/matrixorigin/matrixone/pull/15123) [#15145](https://github.com/matrixorigin/matrixone/pull/15145)

有关其他错误修复，请参阅**变化**部分了解更多详细信息。

## 变化

- support parallel config for backup (#1.1-dev) by @YANGGMM in [#14539](https://github.com/matrixorigin/matrixone/pull/14539)
- fix bug by @triump2020 in [#14527](https://github.com/matrixorigin/matrixone/pull/14527)
- cherry-pick index related commits to 1.1-dev by @aunjgr in [#14519](https://github.com/matrixorigin/matrixone/pull/14519)
- Add backup parallel by @LeftHandCold in [#14543](https://github.com/matrixorigin/matrixone/pull/14543)
- Move write-offset update from Ranges to Relation [#14434](https://github.com/matrixorigin/matrixone/pull/14434) by @ouyuanning in [#14545](https://github.com/matrixorigin/matrixone/pull/14545)
- Add more precise workspace size control [#14497](https://github.com/matrixorigin/matrixone/pull/14497) by @ouyuanning in [#14546](https://github.com/matrixorigin/matrixone/pull/14546)
- fix data race (cherry-pick [#14429](https://github.com/matrixorigin/matrixone/pull/14429)) by @jiangxinmeng1 in [#14439](https://github.com/matrixorigin/matrixone/pull/14439)
- sync to 1.1: increase the default val of the tn rpc worker by @gouhongshen in [#14582](https://github.com/matrixorigin/matrixone/pull/14582)
- fix scanner(1.1-dev) by @YANGGMM in [#14567](https://github.com/matrixorigin/matrixone/pull/14567)
- [Bug]: Incorrect explain in bvt with race enabled to 1.1-dev by @badboynt1 in [#14596](https://github.com/matrixorigin/matrixone/pull/14596)
- support isnull and isnotnull in block filter to 1.1-dev by @badboynt1 in [#14595](https://github.com/matrixorigin/matrixone/pull/14595)
- fileservice: add NoDefaultCredentialsForETL by @reusee in [#14565](https://github.com/matrixorigin/matrixone/pull/14565)
- fix writeoffset data race by @Morranto in [#14606](https://github.com/matrixorigin/matrixone/pull/14606)
- sync to 1.1: an interface for copy-on-write of table def by @gouhongshen in [#14626](https://github.com/matrixorigin/matrixone/pull/14626)
- fix bug: get incorrect result for "in" expr in some case [#14602](https://github.com/matrixorigin/matrixone/pull/14602) by @ouyuanning in [#14631](https://github.com/matrixorigin/matrixone/pull/14631)
- fix dump enum type error (#1.1-dev) by @YANGGMM in [#14655](https://github.com/matrixorigin/matrixone/pull/14527)
- fix scanner for '#' (#1.1-dev) by @YANGGMM in [#14659](https://github.com/matrixorigin/matrixone/pull/14659)
- sync to 1.1: adding detailed phased trace in the TN commit routine helps us catch the time killer when TN commits. by @gouhongshen in [#14663](https://github.com/matrixorigin/matrixone/pull/14663)
- 1.1: check nil vector before flushing blk & print w-w detail in pessimistic mode by @aptend in [#14653](https://github.com/matrixorigin/matrixone/pull/14653)
- sync to 1.1: clean all usage of the StartTxnWithLastestTs by @gouhongshen in [#14684](https://github.com/matrixorigin/matrixone/pull/14684)
- 1.1: add flush range lag by @aptend in [#14690](https://github.com/matrixorigin/matrixone/pull/14690)
- fix constant folding of literal vector with 1 item by @aunjgr in [#14719](https://github.com/matrixorigin/matrixone/pull/14719)
- 1.1: fix wrong Next call on memory deletes collecting by @aptend in [#14759](https://github.com/matrixorigin/matrixone/pull/14759)
- Fix TestAppendAndGC for 1.1 by @LeftHandCold in [#14768](https://github.com/matrixorigin/matrixone/pull/14768)
- sync to 1.1: restore the switched account id when mo_table_size and mo_table_rows. by @gouhongshen in [#14741](https://github.com/matrixorigin/matrixone/pull/14741)
- fix: fixed panic when python server cannot be connected [#14145](https://github.com/matrixorigin/matrixone/pull/14145) by @aylei in [#14735](https://github.com/matrixorigin/matrixone/pull/14735)
- Fix memory leak caused by fuzzyfilter by @jensenojs in [#14777](https://github.com/matrixorigin/matrixone/pull/14777)
- Added back to the release of compile and its referenced objects by @jensenojs in [#14791](https://github.com/matrixorigin/matrixone/pull/14791)
- sync to 1.1: fix the logic err in PrefixIn when vector unsorted by @gouhongshen in [#14797](https://github.com/matrixorigin/matrixone/pull/14797)
- [bug] BR: fix bug when restoring data by @volgariver6 in [#14800](https://github.com/matrixorigin/matrixone/pull/14800)
- fileservice: add ObjectStorageArguments.NoBucketValidation [#14510](https://github.com/matrixorigin/matrixone/pull/14510) by @reusee in [#14808](https://github.com/matrixorigin/matrixone/pull/14808)
- modify mo_task primary key type to bigint in 1.1 by @w-zr in [#14809](https://github.com/matrixorigin/matrixone/pull/14809)
- remove some stats to improve tp performance in 1.1-dev by @XuPeng-SH in [#14819](https://github.com/matrixorigin/matrixone/pull/14819)
- [fix]: fix [#14521](https://github.com/matrixorigin/matrixone/pull/14521) by @jensenojs in [#14816](https://github.com/matrixorigin/matrixone/pull/14816)
- fix data race in ApplyCommit, cherry-pick [#14709](https://github.com/matrixorigin/matrixone/pull/14709) by @jiangxinmeng1 in [#14822](https://github.com/matrixorigin/matrixone/pull/14822)
- change plan for insert without unique key column [#14713](https://github.com/matrixorigin/matrixone/pull/14713) by @ouyuanning in [#14802](https://github.com/matrixorigin/matrixone/pull/14802)
- cherry pick fix [#14780](https://github.com/matrixorigin/matrixone/pull/14780) [#14782](https://github.com/matrixorigin/matrixone/pull/14782) to 1.1-dev by @XuPeng-SH in [#14818](https://github.com/matrixorigin/matrixone/pull/14818)
- Remove writes from the table by @nnsgmsone in [#14830](https://github.com/matrixorigin/matrixone/pull/14830)
- fix a bug that the runtime filter is not pushed for 1.1 by @badboynt1 in [#14835](https://github.com/matrixorigin/matrixone/pull/14835)
- [enhancement] proxy: transfer connection more proactively by @volgariver6 in [#14858](https://github.com/matrixorigin/matrixone/pull/14858)
- fix split command, cherry-pick [#14855](https://github.com/matrixorigin/matrixone/pull/14855) by @jiangxinmeng1 in [#14862](https://github.com/matrixorigin/matrixone/pull/14862)
- [bug] fix ut case by @volgariver6 in [#14853](https://github.com/matrixorigin/matrixone/pull/14853)
- [1.1-dev] add GetPipelineInfo API to query-service by @aylei in [#14847](https://github.com/matrixorigin/matrixone/pull/14847)
- [1.1-dev] feat: add from proxy to status session by @aylei in [#14848](https://github.com/matrixorigin/matrixone/pull/14848)
- cherry-pick to 1.1dev: add character set by @daviszhen in [#14874](https://github.com/matrixorigin/matrixone/pull/14874)
- sync to 1.1: fix the storage usage obj double delete by @gouhongshen in [#14870](https://github.com/matrixorigin/matrixone/pull/14870)
- cherry pick "optimize sql statement with limit 0 [#14884](https://github.com/matrixorigin/matrixone/pull/14884)" to 1.1-dev by @badboynt1 in [#14889](https://github.com/matrixorigin/matrixone/pull/14889)
- cherry-pick to 1.1dev: add rollback last statement by @daviszhen in [#14892](https://github.com/matrixorigin/matrixone/pull/14892)
- [bug] proxy: fix lost connection issue in tpcc test. by @volgariver6 in [#14896](https://github.com/matrixorigin/matrixone/pull/14896)
- Add task schedule in 1.1 by @w-zr in [#14857](https://github.com/matrixorigin/matrixone/pull/14857)
- [enhancement] proxy: migrate prepare stmts when connection is transferred from one cn to another one. by @volgariver6 in [#14901](https://github.com/matrixorigin/matrixone/pull/14901)
- fix bug: can not show databases after drop database [#14899](https://github.com/matrixorigin/matrixone/pull/14899) by @ouyuanning in [#14904](https://github.com/matrixorigin/matrixone/pull/14904)
- cherry pick dup by @triump2020 in [#14922](https://github.com/matrixorigin/matrixone/pull/14922)
- Background query run in selected CN in 1.1 by @xzxiong in [#14881](https://github.com/matrixorigin/matrixone/pull/14881)
- cherry-pick to 1.1-dev: add foreign key self refer by @daviszhen in [#14887](https://github.com/matrixorigin/matrixone/pull/14887)
- sync to 1.1: adjust the db, table visibility in show accounts by @gouhongshen in [#14924](https://github.com/matrixorigin/matrixone/pull/14924)
- Estimate the tcp packet num response in 1.1 by @xzxiong in [#14885](https://github.com/matrixorigin/matrixone/pull/14885)
- fix insert into enum type with select clause (#1.1-dev) by @YANGGMM in [#14921](https://github.com/matrixorigin/matrixone/pull/14921)
- CU calculation & metric improvement in 1.1 by @xzxiong in [#14948](https://github.com/matrixorigin/matrixone/pull/14948)
- support insert into time/datetime/timestamp type with hint (#1.1-dev) by @YANGGMM in [#14952](https://github.com/matrixorigin/matrixone/pull/14952)
- cherry-pick to 1.1dev: update kinds of abnormal txn behavior by @daviszhen in [#14942](https://github.com/matrixorigin/matrixone/pull/14942)
- sync to 1.1: counting index table sizes and the original table size together when mo_table_size by @gouhongshen in [#14954](https://github.com/matrixorigin/matrixone/pull/14954)
- cherrypick to 1.1-dev: add statement latency metric by @EZ4BRUCE in [#14966](https://github.com/matrixorigin/matrixone/pull/14966)
- return allocate error in auto increment service to 1.1 by @zhangxu19830126 in [#14868](https://github.com/matrixorigin/matrixone/pull/14868)
- [Improvement]: For auto incr unique key, remove deduplication detection if there will be no conflict by @jensenojs in [#14980](https://github.com/matrixorigin/matrixone/pull/14980)
- [BugFix]: Upgrade Not getting applied to System Tenant by @arjunsk in [#14990](https://github.com/matrixorigin/matrixone/pull/14990)
- fix bug: get deleted db when autocommit=0 (#14957) by @ouyuanning in [#14977](https://github.com/matrixorigin/matrixone/pull/14977)
- fix lock not found or changed in new txn by @iamlinjunhong in [#14984](https://github.com/matrixorigin/matrixone/pull/14984)
-retry ww conflict in optimistic mode to 1.1 by @zhangxu19830126 in [#14994](https://github.com/matrixorigin/matrixone/pull/14994)
- cherry pick by @triump2020 in [#14992](https://github.com/matrixorigin/matrixone/pull/14992)
- bugfix 1.1: account access table in system_metrics db need redirect to sys by @xzxiong in [#14998](https://github.com/matrixorigin/matrixone/pull/14998)
- fix panic by @zhangxu19830126 in [#15023](https://github.com/matrixorigin/matrixone/pull/15023)
- improve filter cu by @Morranto in [#15003](https://github.com/matrixorigin/matrixone/pull/15003)
- [Cherry-pick] fix delete nil routine [#14951](https://github.com/matrixorigin/matrixone/pull/14951) by @ck89119 in [#15026](https://github.com/matrixorigin/matrixone/pull/15026)
- cherry pick for fix dup-ww-2 by @triump2020 in [#15034](https://github.com/matrixorigin/matrixone/pull/15034)
- fix json_extract (#1.1-dev) by @YANGGMM in [#15035](https://github.com/matrixorigin/matrixone/pull/15035)
- fix update contains enum type col (#1.1-dev) by @YANGGMM in [#15041](https://github.com/matrixorigin/matrixone/pull/15041)
- support insert ignore syntax (#1.1-dev) by @YANGGMM in [#15053](https://github.com/matrixorigin/matrixone/pull/15053)
- fix show table status by @YANGGMM in [#15056](https://github.com/matrixorigin/matrixone/pull/15056)
- [Fix] tableName and dbName of col in resultset by @ck89119 in [#15048](https://github.com/matrixorigin/matrixone/pull/15048)
- fix bug: compile time is incorrect by @ouyuanning in [#15072](https://github.com/matrixorigin/matrixone/pull/15072)
- cherry-pick to 1.1dev: add fk forward reference by @daviszhen in [#15047](https://github.com/matrixorigin/matrixone/pull/15047)
- fix bug: use different proc when run internal stmt [#15040](https://github.com/matrixorigin/matrixone/pull/15040) by @ouyuanning in [#15078](https://github.com/matrixorigin/matrixone/pull/15078)
- [bug] tpcc failed after transfer happened by @volgariver6 in [#15091](https://github.com/matrixorigin/matrixone/pull/15091)
- disable pre-allocate on uncommitted txn to 1.1 by @zhangxu19830126 in [#15104](https://github.com/matrixorigin/matrixone/pull/15104)
- Fix/add sysviews 1.1 by @ck89119 in [#15108](https://github.com/matrixorigin/matrixone/pull/15108)
- make the 'mo_catalog' visible to all account by @zhangxu19830126 in [#15122](https://github.com/matrixorigin/matrixone/pull/1512)
- fix lower case table names (#1.1-dev) by @YANGGMM in [#15098](https://github.com/matrixorigin/matrixone/pull/15098)
- cherry pick fix-dup-ww-3 by @triump2020 in [#15123](https://github.com/matrixorigin/matrixone/pull/15123)
- add case for db information_schema to 1.1-dev by @Ariznawlll in [#15131](https://github.com/matrixorigin/matrixone/pull/15131)
- fix metric, stats in 1.1 by @xzxiong in [#15134](https://github.com/matrixorigin/matrixone/pull/15134)
- [Fix] COLLATE in predicate by @ck89119 in[#15137](https://github.com/matrixorigin/matrixone/pull/15137)
- Fix halloween by @triump2020 in [#15145](https://github.com/matrixorigin/matrixone/pull/15145)
- [bug] change a default config value to workaround a transfer bug. by @volgariver6 in [#15150](https://github.com/matrixorigin/matrixone/pull/15150)
- [fix]: prevent table scan for fuzzy filter from running on multiple CNs to fix moc2765 (1.1-dev) by @jensenojs in [#15143](https://github.com/matrixorigin/matrixone/pull/15143)
- use max memory size of Operator to compute CU [#15132](https://github.com/matrixorigin/matrixone/pull/15132) by @ouyuanning in [#15146](https://github.com/matrixorigin/matrixone/pull/15146)
- add force global checkpoint, cherry pick #15043 by @jiangxinmeng1 in [#15152](https://github.com/matrixorigin/matrixone/pull/15152)
- fileservice: add ObjectStorageArguments.shouldLoadDefaultCredentials by @reusee in [#15156](https://github.com/matrixorigin/matrixone/pull/15156)
- [bug] when migrate prepare stmt, migrate param types filed. by @volgariver6 in [#15162](https://github.com/matrixorigin/matrixone/pull/15162)
- fix desc enum type col table lost content (#1.1-dev) by @YANGGMM in [#15159](https://github.com/matrixorigin/matrixone/pull/15159)
- fix free future multi-times to 1.1 by @zhangxu19830126 in [#15167](https://github.com/matrixorigin/matrixone/pull/15167)
- [postfix] proxy: transfer connections failed by @volgariver6 in [#15172](https://github.com/matrixorigin/matrixone/pull/15172)
- disable close tcp connection due to heartbeat timeout to 1.1 by @zhangxu19830126 in [#15183](https://github.com/matrixorigin/matrixone/pull/15183)
- use pool to create uuid (#1.1-dev) by @YANGGMM in [#15187](https://github.com/matrixorigin/matrixone/pull/15187)
- [Fix] session leakage by @ck89119 in [#15193](https://github.com/matrixorigin/matrixone/pull/15193)
- fix wrong result caused by prefix_eq (cherry-pick to 1.1-dev) by @aunjgr in [#15195](https://github.com/matrixorigin/matrixone/pull/15195)
- [Fix] concurrent problem of sessionMgr by @ck89119 in [#15210](https://github.com/matrixorigin/matrixone/pull/15210)
- fix panic by @zhangxu19830126 in [#15218](https://github.com/matrixorigin/matrixone/pull/15218)
- add collate utf_8 case(1.1-dev) by @Ariznawlll in [#15223](https://github.com/matrixorigin/matrixone/pull/15223)
- fix bug: panic happened when select table(filter with unique key col)… by @ouyuanning in [#15234](https://github.com/matrixorigin/matrixone/pull/15234)
- fix alter table add enum col (#1.1-dev) by @YANGGMM in [#15237](https://github.com/matrixorigin/matrixone/pull/15237)
- MOLogger conn run with cn-labelSelector while do Compile by @xzxiong in [#15228](https://github.com/matrixorigin/matrixone/pull/15228)
- add select for update case by @Ariznawlll in [#15242](https://github.com/matrixorigin/matrixone/pull/15242)
- [bug] proxy: fix proxy transfer issue by @volgariver6 in [#15247](https://github.com/matrixorigin/matrixone/pull/15247)
- fix explain by @daviszhen in [#15270](https://github.com/matrixorigin/matrixone/pull/15270)

## 更详细的更新日志

<https://github.com/matrixorigin/matrixone/compare/v1.1.1...v1.1.2>